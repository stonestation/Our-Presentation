
// Works data with categories
const worksData = [
    {
        id: 1,
        title: "Stone Station ",
        image: "images/exterior/eximg-1.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 2,
        title: "Stone Station ",
        image: "images/exterior/eximg-2.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },

    {
        id: 3,
        title: "Stone Station ",
        image: "images/exterior/eximg-3.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 4,
        title: "Stone Station ",
        image: "images/interior/inimg-1.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 5,
        title: "Stone Station ",
        image: "images/interior/inimg-2.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 6,
        title: "Stone Station ",
        image: "images/interior/inimg-3.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 7,
        title: "Stone Station ",
        image: "images/exterior/eximg-4.JPG",

        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 8,
        title: "Stone Station ",
        image: "images/exterior/eximg-5.jpg",

        location: "Rajkot",
        category: "exterior",
        material: ""
    },

    {
        id: 9,
        title: "Stone Station ",
        image: "images/exterior/eximg-6.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 10,
        title: "Stone Station ",
        image: "images/interior/inimg-4.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 11,
        title: "Stone Station ",
        image: "images/interior/inimg-5.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 12,
        title: "Stone Station ",
        image: "images/interior/inimg-6.jpg",

        location: "Rajkot",
        category: "interior",
        material: ""
    },


    {
        id: 13,
        title: "Stone Station ",
        image: "images/exterior/eximg-7.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 14,
        title: "Stone Station ",
        image: "images/exterior/eximg-8.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },

    {
        id: 15,
        title: "Stone Station ",
        image: "images/exterior/eximg-9.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 16,
        title: "Stone Station ",
        image: "images/interior/inimg-7.jpg",

        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 17,
        title: "Stone Station ",
        image: "images/interior/inimg-8.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 18,
        title: "Stone Station ",
        image: "images/interior/inimg-9.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 19,
        title: "Stone Station ",
        image: "images/exterior/eximg-10.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 20,
        title: "Stone Station ",
        image: "images/exterior/eximg-11.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },

    {
        id: 21,
        title: "Stone Station ",
        image: "images/exterior/eximg-12.jpg",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 22,
        title: "Stone Station ",
        image: "images/interior/inimg-13.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 23,
        title: "Stone Station ",
        image: "images/interior/inimg-14.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 24,
        title: "Stone Station ",
        image: "images/interior/inimg-15.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 25,
        title: "Stone Station ",
        image: "images/exterior/eximg-13.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 26,
        title: "Stone Station ",
        image: "images/exterior/eximg-14.JPG",
        location: "Rajkot",
        category: "exterior",
        material: ""
    },
    {
        id: 27,
        title: "Stone Station ",
        image: "images/interior/inimg-16.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 28,
        title: "Stone Station ",
        image: "images/interior/inimg-17.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

    {
        id: 29,
        title: "Stone Station ",
        image: "images/interior/inimg-18.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 30,
        title: "Stone Station ",
        image: "images/interior/inimg-19.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 31,
        title: "Stone Station ",
        image: "images/interior/inimg-20.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 32,
        title: "Stone Station ",
        image: "images/interior/inimg-21.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 33,
        title: "Stone Station ",
        image: "images/interior/inimg-22.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 34,
        title: "Stone Station ",
        image: "images/interior/inimg-23.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 35,
        title: "Stone Station ",
        image: "images/interior/inimg-24.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 36,
        title: "Stone Station ",
        image: "images/interior/inimg-25.JPEG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 37,
        title: "Stone Station ",
        image: "images/interior/inimg-26.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 38,
        title: "Stone Station ",
        image: "images/interior/inimg-27.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 39,
        title: "Stone Station ",
        image: "images/interior/inimg-28.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 40,
        title: "Stone Station ",
        image: "images/interior/inimg-29.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    }, {
        id: 41,
        title: "Stone Station ",
        image: "images/interior/inimg-30.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 42,
        title: "Stone Station ",
        image: "images/interior/inimg-31.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 43,
        title: "Stone Station ",
        image: "images/interior/inimg-32.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 44,
        title: "Stone Station ",
        image: "images/interior/inimg-33.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 45,
        title: "Stone Station ",
        image: "images/interior/inimg-34.JPEG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 46,
        title: "Stone Station ",
        image: "images/interior/inimg-35.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 47,
        title: "Stone Station ",
        image: "images/interior/inimg-36.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 48,
        title: "Stone Station ",
        image: "images/interior/inimg-37.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 49,
        title: "Stone Station ",
        image: "images/interior/inimg-38.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 50,
        title: "Stone Station ",
        image: "images/interior/inimg-39.JPEG",

        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 51,
        title: "Stone Station ",
        image: "images/interior/inimg-40.jpg",
        location: "Rajkot",
        category: "interior",
        material: ""
    },
    {
        id: 52,
        title: "Stone Station ",
        image: "images/interior/inimg-41.JPG",
        location: "Rajkot",
        category: "interior",
        material: ""
    },

];

document.addEventListener('DOMContentLoaded', function () {
    const galleryContainer = document.getElementById('gallery-container');
    const categoryBtns = document.querySelectorAll('.category-btn');
    const zoomModal = document.getElementById('zoom-modal');
    const zoomedImage = document.getElementById('zoomed-image');
    const closeZoom = document.querySelector('.close-zoom');
    const prevZoom = document.getElementById('prev-zoom');
    const nextZoom = document.getElementById('next-zoom');
    const zoomInBtn = document.getElementById('zoom-in');
    const zoomOutBtn = document.getElementById('zoom-out');
    const zoomResetBtn = document.getElementById('zoom-reset');

    let currentZoomIndex = 0;
    let currentCategory = 'all';
    let filteredWorks = [];
    let scale = 1;
    let isDragging = false;
    let startX, startY, scrollLeft, scrollTop;
    let touchStartX, touchStartY;
    let initialDistance = 0;
    let lastTouchTime = 0;

    // Generate gallery items
    function generateGalleryItems(works) {
        galleryContainer.innerHTML = '';

        works.forEach((work, index) => {
            const galleryItem = document.createElement('div');
            galleryItem.className = 'gallery-item';
            galleryItem.setAttribute('data-id', work.id);
            galleryItem.setAttribute('data-index', index);

            galleryItem.innerHTML = `
                        <img src="${work.image}" alt="${work.title}" class="gallery-image">
                        <div class="gallery-info">
                            <h3 class="gallery-title">${work.title}</h3>
                            <div class="gallery-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${work.location}</span>
                            </div>
                            <span class="gallery-category">${work.category} â€¢ ${work.material}</span>
                        </div>
                    `;

            galleryContainer.appendChild(galleryItem);
        });

        // Add click event to gallery images
        document.querySelectorAll('.gallery-image').forEach(img => {
            img.addEventListener('click', function () {
                const item = this.closest('.gallery-item');
                const index = parseInt(item.getAttribute('data-index'));
                openZoom(index);
            });
        });
    }

    // Filter works by category
    function filterWorks(category) {
        if (category === 'all') {
            filteredWorks = [...worksData];
        } else {
            filteredWorks = worksData.filter(work => work.category === category);
        }
        generateGalleryItems(filteredWorks);
    }

    // Open zoom modal
    function openZoom(index) {
        currentZoomIndex = index;
        const work = filteredWorks[currentZoomIndex];
        zoomedImage.src = work.image;
        zoomModal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        resetZoom();
    }

    // Close zoom modal
    function closeZoomModal() {
        zoomModal.style.display = 'none';
        document.body.style.overflow = 'auto';
        resetZoom();
    }

    // Reset zoom to default
    function resetZoom() {
        scale = 1;
        zoomedImage.style.transform = `scale(${scale})`;
        zoomedImage.style.cursor = 'grab';
        zoomedImage.classList.remove('grabbing');
        isDragging = false;

        // Center the image
        zoomedImage.scrollLeft = 0;
        zoomedImage.scrollTop = 0;
    }

    // Apply zoom transformation
    function applyZoom() {
        zoomedImage.style.transform = `scale(${scale})`;
        zoomedImage.style.cursor = scale > 1 ? 'grab' : 'default';
    }

    // Zoom in/out functionality
    function zoomImage(delta) {
        const prevScale = scale;
        scale += delta;

        // Limit zoom range (0.5x to 3x)
        scale = Math.max(0.5, Math.min(scale, 3));

        if (scale !== prevScale) {
            applyZoom();
        }
    }

    // Navigate between images
    function navigateZoom(direction) {
        currentZoomIndex = (currentZoomIndex + direction + filteredWorks.length) % filteredWorks.length;
        const work = filteredWorks[currentZoomIndex];
        zoomedImage.src = work.image;
        resetZoom();
    }

    // Initialize gallery
    filterWorks('all');

    // Category filter event listeners
    categoryBtns.forEach(btn => {
        btn.addEventListener('click', function () {
            categoryBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            currentCategory = this.getAttribute('data-category');
            filterWorks(currentCategory);
        });
    });

    // Zoom modal event listeners
    closeZoom.addEventListener('click', closeZoomModal);
    prevZoom.addEventListener('click', () => navigateZoom(-1));
    nextZoom.addEventListener('click', () => navigateZoom(1));
    zoomInBtn.addEventListener('click', () => zoomImage(0.2));
    zoomOutBtn.addEventListener('click', () => zoomImage(-0.2));
    zoomResetBtn.addEventListener('click', resetZoom);

    // Close modal when clicking on background
    zoomModal.addEventListener('click', function (e) {
        if (e.target === this) {
            closeZoomModal();
        }
    });

    // Keyboard navigation
    document.addEventListener('keydown', function (e) {
        if (zoomModal.style.display === 'flex') {
            if (e.key === 'Escape') {
                closeZoomModal();
            } else if (e.key === 'ArrowLeft') {
                navigateZoom(-1);
            } else if (e.key === 'ArrowRight') {
                navigateZoom(1);
            } else if (e.key === '+' || e.key === '=') {
                zoomImage(0.2);
            } else if (e.key === '-' || e.key === '_') {
                zoomImage(-0.2);
            } else if (e.key === '0') {
                resetZoom();
            }
        }
    });

    // Mouse wheel zoom
    zoomedImage.addEventListener('wheel', function (e) {
        e.preventDefault();
        const delta = e.deltaY > 0 ? -0.1 : 0.1;
        zoomImage(delta);
    });

    // Drag to pan when zoomed
    zoomedImage.addEventListener('mousedown', function (e) {
        if (scale > 1) {
            isDragging = true;
            startX = e.pageX - zoomedImage.offsetLeft;
            startY = e.pageY - zoomedImage.offsetTop;
            scrollLeft = zoomedImage.scrollLeft;
            scrollTop = zoomedImage.scrollTop;
            zoomedImage.style.cursor = 'grabbing';
            zoomedImage.classList.add('grabbing');
        }
    });

    document.addEventListener('mousemove', function (e) {
        if (!isDragging) return;
        e.preventDefault();
        const x = e.pageX - zoomedImage.offsetLeft;
        const y = e.pageY - zoomedImage.offsetTop;
        const walkX = (x - startX) * 2;
        const walkY = (y - startY) * 2;
        zoomedImage.scrollLeft = scrollLeft - walkX;
        zoomedImage.scrollTop = scrollTop - walkY;
    });

    document.addEventListener('mouseup', function () {
        if (isDragging) {
            isDragging = false;
            zoomedImage.style.cursor = scale > 1 ? 'grab' : 'default';
            zoomedImage.classList.remove('grabbing');
        }
    });

    // Touch support for mobile
    zoomedImage.addEventListener('touchstart', function (e) {
        if (e.touches.length === 1) {
            // Single touch for dragging
            if (scale > 1) {
                isDragging = true;
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
                scrollLeft = zoomedImage.scrollLeft;
                scrollTop = zoomedImage.scrollTop;
            }

            // Double tap detection
            const currentTime = new Date().getTime();
            if (currentTime - lastTouchTime < 300) {
                // Double tap
                if (scale > 1.5) {
                    resetZoom();
                } else {
                    zoomImage(1);
                }
            }
            lastTouchTime = currentTime;
        } else if (e.touches.length === 2) {
            // Two touches for pinch zoom
            e.preventDefault();
            initialDistance = Math.hypot(
                e.touches[0].clientX - e.touches[1].clientX,
                e.touches[0].clientY - e.touches[1].clientY
            );
        }
    }, { passive: false });

    zoomedImage.addEventListener('touchmove', function (e) {
        if (e.touches.length === 1 && isDragging) {
            // Single touch drag
            e.preventDefault();
            const touchX = e.touches[0].clientX;
            const touchY = e.touches[0].clientY;
            const walkX = (touchX - touchStartX) * 2;
            const walkY = (touchY - touchStartY) * 2;
            zoomedImage.scrollLeft = scrollLeft - walkX;
            zoomedImage.scrollTop = scrollTop - walkY;
        } else if (e.touches.length === 2) {
            // Pinch zoom
            e.preventDefault();
            const currentDistance = Math.hypot(
                e.touches[0].clientX - e.touches[1].clientX,
                e.touches[0].clientY - e.touches[1].clientY
            );

            if (initialDistance > 0) {
                const delta = (currentDistance - initialDistance) / 200;
                zoomImage(delta);
            }

            initialDistance = currentDistance;
        }
    }, { passive: false });

    zoomedImage.addEventListener('touchend', function () {
        isDragging = false;
        initialDistance = 0;
    });

    // Prevent scrolling when zooming
    document.addEventListener('touchmove', function (e) {
        if (zoomModal.style.display === 'flex') {
            e.preventDefault();
        }
    }, { passive: false });

    // Check URL for a temporary token
if (new URL(window.location.href).searchParams.get("token") !== "SECRET_KEY") {
    window.location.href = "https://stonestation.com/404"; // Redirect if invalid
}
});
